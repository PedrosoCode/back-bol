--
-- PostgreSQL database dump
--

\restrict oYs6oFWpGaRp1juFmdKKXMDndm2afhqEeYdpaFXXEqsJpa8NwbOqu0SSk8TkJ5Q

-- Dumped from database version 16.10 (Ubuntu 16.10-0ubuntu0.24.04.1)
-- Dumped by pg_dump version 16.10 (Ubuntu 16.10-0ubuntu0.24.04.1)

-- Started on 2025-10-10 22:20:48 -03

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 224 (class 1255 OID 17332)
-- Name: fn_auth_select_empresa(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.fn_auth_select_empresa() RETURNS TABLE(codigo integer, nome_fantasia character varying)
    LANGUAGE plpgsql
    AS $$
BEGIN
    RETURN QUERY
    SELECT 
		tbl.codigo, 
		tbl.nome_fantasia
    FROM tb_cad_empresa tbl;
END;
$$;


ALTER FUNCTION public.fn_auth_select_empresa() OWNER TO postgres;

--
-- TOC entry 225 (class 1255 OID 17336)
-- Name: fn_auth_valida_senha(character varying, integer); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.fn_auth_valida_senha(p_usuario character varying, p_codigo_empresa integer) RETURNS TABLE(codigo integer, usuario character varying, senha character varying)
    LANGUAGE plpgsql
    AS $$
BEGIN
    RETURN QUERY
    SELECT tbl.codigo, tbl.usuario, tbl.senha
    FROM tb_cad_usuario tbl
    WHERE tbl.usuario = p_usuario
      AND tbl.codigo_empresa = p_codigo_empresa;
END;
$$;


ALTER FUNCTION public.fn_auth_valida_senha(p_usuario character varying, p_codigo_empresa integer) OWNER TO postgres;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 215 (class 1259 OID 17177)
-- Name: tb_cad_empresa; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tb_cad_empresa (
    codigo integer NOT NULL,
    cnpj_cpf character varying,
    nome_fantasia character varying,
    razao_social character varying
);


ALTER TABLE public.tb_cad_empresa OWNER TO postgres;

--
-- TOC entry 217 (class 1259 OID 17211)
-- Name: tb_cad_item; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tb_cad_item (
    codigo integer NOT NULL,
    codigo_empresa integer NOT NULL,
    codigo_item character varying,
    descricao character varying
);


ALTER TABLE public.tb_cad_item OWNER TO postgres;

--
-- TOC entry 222 (class 1259 OID 17295)
-- Name: tb_cad_modelo_maquina; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tb_cad_modelo_maquina (
    codigo integer NOT NULL,
    codigo_empresa integer NOT NULL,
    codigo_tipo_maquina integer,
    descricao character varying
);


ALTER TABLE public.tb_cad_modelo_maquina OWNER TO postgres;

--
-- TOC entry 216 (class 1259 OID 17184)
-- Name: tb_cad_parceiro_negocio; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tb_cad_parceiro_negocio (
    codigo integer NOT NULL,
    codigo_empresa integer NOT NULL,
    nome_fantasia character varying,
    razao_social character varying,
    cnpj_cpf character varying,
    codigo_pais integer,
    codigo_estado integer,
    codigo_cidade integer,
    bairro character varying,
    rua character varying,
    n_rua character varying,
    cep character varying,
    inscricao_estadual character varying,
    cnae_principal character varying,
    codigo_regime_tributario integer
);


ALTER TABLE public.tb_cad_parceiro_negocio OWNER TO postgres;

--
-- TOC entry 218 (class 1259 OID 17223)
-- Name: tb_cad_servico; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tb_cad_servico (
    codigo integer NOT NULL,
    codigo_empresa integer NOT NULL,
    codigo_servico character varying,
    descricao character varying
);


ALTER TABLE public.tb_cad_servico OWNER TO postgres;

--
-- TOC entry 221 (class 1259 OID 17283)
-- Name: tb_cad_tipo_maquina; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tb_cad_tipo_maquina (
    codigo integer NOT NULL,
    codigo_empresa integer NOT NULL,
    descricao character varying
);


ALTER TABLE public.tb_cad_tipo_maquina OWNER TO postgres;

--
-- TOC entry 223 (class 1259 OID 17312)
-- Name: tb_cad_usuario; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tb_cad_usuario (
    codigo integer NOT NULL,
    codigo_empresa integer NOT NULL,
    senha character varying,
    nome character varying,
    usuario character varying
);


ALTER TABLE public.tb_cad_usuario OWNER TO postgres;

--
-- TOC entry 219 (class 1259 OID 17248)
-- Name: tb_servico_ordem_servico; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tb_servico_ordem_servico (
    codigo integer NOT NULL,
    codigo_empresa integer NOT NULL,
    codigo_parceiro_negocio integer,
    numero_os integer
);


ALTER TABLE public.tb_servico_ordem_servico OWNER TO postgres;

--
-- TOC entry 220 (class 1259 OID 17273)
-- Name: tb_servico_ordem_servico_linha; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tb_servico_ordem_servico_linha (
    codigo integer NOT NULL,
    codigo_empresa integer NOT NULL,
    codigo_ordem_servico integer NOT NULL,
    codigo_produto_servico integer,
    quantidade numeric(15,5),
    valor_unitario numeric(15,5),
    tipo_item_servico character(1)
);


ALTER TABLE public.tb_servico_ordem_servico_linha OWNER TO postgres;

--
-- TOC entry 3455 (class 0 OID 17177)
-- Dependencies: 215
-- Data for Name: tb_cad_empresa; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tb_cad_empresa (codigo, cnpj_cpf, nome_fantasia, razao_social) FROM stdin;
1	a	teste	teste
\.


--
-- TOC entry 3457 (class 0 OID 17211)
-- Dependencies: 217
-- Data for Name: tb_cad_item; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tb_cad_item (codigo, codigo_empresa, codigo_item, descricao) FROM stdin;
\.


--
-- TOC entry 3462 (class 0 OID 17295)
-- Dependencies: 222
-- Data for Name: tb_cad_modelo_maquina; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tb_cad_modelo_maquina (codigo, codigo_empresa, codigo_tipo_maquina, descricao) FROM stdin;
\.


--
-- TOC entry 3456 (class 0 OID 17184)
-- Dependencies: 216
-- Data for Name: tb_cad_parceiro_negocio; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tb_cad_parceiro_negocio (codigo, codigo_empresa, nome_fantasia, razao_social, cnpj_cpf, codigo_pais, codigo_estado, codigo_cidade, bairro, rua, n_rua, cep, inscricao_estadual, cnae_principal, codigo_regime_tributario) FROM stdin;
\.


--
-- TOC entry 3458 (class 0 OID 17223)
-- Dependencies: 218
-- Data for Name: tb_cad_servico; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tb_cad_servico (codigo, codigo_empresa, codigo_servico, descricao) FROM stdin;
\.


--
-- TOC entry 3461 (class 0 OID 17283)
-- Dependencies: 221
-- Data for Name: tb_cad_tipo_maquina; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tb_cad_tipo_maquina (codigo, codigo_empresa, descricao) FROM stdin;
\.


--
-- TOC entry 3463 (class 0 OID 17312)
-- Dependencies: 223
-- Data for Name: tb_cad_usuario; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tb_cad_usuario (codigo, codigo_empresa, senha, nome, usuario) FROM stdin;
1	1	$2b$10$3bswB1SWCRQu9gCBhG/IXuHJ5wBwOiHaGIzSR7dI6GMy6kOLB/mjC	pedroso	pedroso
\.


--
-- TOC entry 3459 (class 0 OID 17248)
-- Dependencies: 219
-- Data for Name: tb_servico_ordem_servico; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tb_servico_ordem_servico (codigo, codigo_empresa, codigo_parceiro_negocio, numero_os) FROM stdin;
\.


--
-- TOC entry 3460 (class 0 OID 17273)
-- Dependencies: 220
-- Data for Name: tb_servico_ordem_servico_linha; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tb_servico_ordem_servico_linha (codigo, codigo_empresa, codigo_ordem_servico, codigo_produto_servico, quantidade, valor_unitario, tipo_item_servico) FROM stdin;
\.


--
-- TOC entry 3289 (class 2606 OID 17217)
-- Name: tb_cad_item pk_item; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_item
    ADD CONSTRAINT pk_item PRIMARY KEY (codigo, codigo_empresa);


--
-- TOC entry 3299 (class 2606 OID 17301)
-- Name: tb_cad_modelo_maquina pk_modelo_maquina; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_modelo_maquina
    ADD CONSTRAINT pk_modelo_maquina PRIMARY KEY (codigo, codigo_empresa);


--
-- TOC entry 3293 (class 2606 OID 17252)
-- Name: tb_servico_ordem_servico pk_ordem_servico; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_servico_ordem_servico
    ADD CONSTRAINT pk_ordem_servico PRIMARY KEY (codigo, codigo_empresa);


--
-- TOC entry 3295 (class 2606 OID 17277)
-- Name: tb_servico_ordem_servico_linha pk_ordem_servico_linha; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_servico_ordem_servico_linha
    ADD CONSTRAINT pk_ordem_servico_linha PRIMARY KEY (codigo, codigo_empresa, codigo_ordem_servico);


--
-- TOC entry 3287 (class 2606 OID 17190)
-- Name: tb_cad_parceiro_negocio pk_parceiro_negocio; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_parceiro_negocio
    ADD CONSTRAINT pk_parceiro_negocio PRIMARY KEY (codigo, codigo_empresa);


--
-- TOC entry 3291 (class 2606 OID 17229)
-- Name: tb_cad_servico pk_servico; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_servico
    ADD CONSTRAINT pk_servico PRIMARY KEY (codigo, codigo_empresa);


--
-- TOC entry 3297 (class 2606 OID 17289)
-- Name: tb_cad_tipo_maquina pk_tipo_maquina; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_tipo_maquina
    ADD CONSTRAINT pk_tipo_maquina PRIMARY KEY (codigo, codigo_empresa);


--
-- TOC entry 3301 (class 2606 OID 17318)
-- Name: tb_cad_usuario pk_usuario; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_usuario
    ADD CONSTRAINT pk_usuario PRIMARY KEY (codigo, codigo_empresa);


--
-- TOC entry 3285 (class 2606 OID 17183)
-- Name: tb_cad_empresa tb_cad_empresa_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_empresa
    ADD CONSTRAINT tb_cad_empresa_pkey PRIMARY KEY (codigo);


--
-- TOC entry 3303 (class 2606 OID 17218)
-- Name: tb_cad_item fk_empresa; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_item
    ADD CONSTRAINT fk_empresa FOREIGN KEY (codigo_empresa) REFERENCES public.tb_cad_empresa(codigo);


--
-- TOC entry 3304 (class 2606 OID 17230)
-- Name: tb_cad_servico fk_empresa; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_servico
    ADD CONSTRAINT fk_empresa FOREIGN KEY (codigo_empresa) REFERENCES public.tb_cad_empresa(codigo);


--
-- TOC entry 3309 (class 2606 OID 17302)
-- Name: tb_cad_modelo_maquina fk_modelo_maquina_empresa; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_modelo_maquina
    ADD CONSTRAINT fk_modelo_maquina_empresa FOREIGN KEY (codigo_empresa) REFERENCES public.tb_cad_empresa(codigo);


--
-- TOC entry 3310 (class 2606 OID 17307)
-- Name: tb_cad_modelo_maquina fk_modelo_maquina_tipo_maquina; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_modelo_maquina
    ADD CONSTRAINT fk_modelo_maquina_tipo_maquina FOREIGN KEY (codigo_tipo_maquina, codigo_empresa) REFERENCES public.tb_cad_tipo_maquina(codigo, codigo_empresa);


--
-- TOC entry 3305 (class 2606 OID 17253)
-- Name: tb_servico_ordem_servico fk_ordem_servico_empresa; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_servico_ordem_servico
    ADD CONSTRAINT fk_ordem_servico_empresa FOREIGN KEY (codigo_empresa) REFERENCES public.tb_cad_empresa(codigo);


--
-- TOC entry 3307 (class 2606 OID 17278)
-- Name: tb_servico_ordem_servico_linha fk_ordem_servico_os; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_servico_ordem_servico_linha
    ADD CONSTRAINT fk_ordem_servico_os FOREIGN KEY (codigo_ordem_servico, codigo_empresa) REFERENCES public.tb_servico_ordem_servico(codigo, codigo_empresa);


--
-- TOC entry 3306 (class 2606 OID 17258)
-- Name: tb_servico_ordem_servico fk_ordem_servico_parceiro; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_servico_ordem_servico
    ADD CONSTRAINT fk_ordem_servico_parceiro FOREIGN KEY (codigo_parceiro_negocio, codigo_empresa) REFERENCES public.tb_cad_parceiro_negocio(codigo, codigo_empresa);


--
-- TOC entry 3302 (class 2606 OID 17191)
-- Name: tb_cad_parceiro_negocio fk_parceiro_empresa; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_parceiro_negocio
    ADD CONSTRAINT fk_parceiro_empresa FOREIGN KEY (codigo_empresa) REFERENCES public.tb_cad_empresa(codigo);


--
-- TOC entry 3308 (class 2606 OID 17290)
-- Name: tb_cad_tipo_maquina fk_tipo_maquina_empresa; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_tipo_maquina
    ADD CONSTRAINT fk_tipo_maquina_empresa FOREIGN KEY (codigo_empresa) REFERENCES public.tb_cad_empresa(codigo);


--
-- TOC entry 3311 (class 2606 OID 17319)
-- Name: tb_cad_usuario fk_usuario_empresa; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tb_cad_usuario
    ADD CONSTRAINT fk_usuario_empresa FOREIGN KEY (codigo_empresa) REFERENCES public.tb_cad_empresa(codigo);


-- Completed on 2025-10-10 22:20:48 -03

--
-- PostgreSQL database dump complete
--

\unrestrict oYs6oFWpGaRp1juFmdKKXMDndm2afhqEeYdpaFXXEqsJpa8NwbOqu0SSk8TkJ5Q

